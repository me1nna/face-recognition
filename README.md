<h1>Face Recognition Pipeline Implementation</h1>

<p><a href="https://www.python.org/"><img src="https://img.shields.io/badge/python-3.8%2B-blue" alt="Python" /></a>
<a href="https://pytorch.org/"><img src="https://img.shields.io/badge/pytorch-1.10%2B-red" alt="PyTorch" /></a>
<a href="LICENSE"><img src="https://img.shields.io/badge/license-MIT-green" alt="License" /></a></p>

<p><img src="https://github.com/me1nna/face-recognition/assets/78222093/47e25f04-dd10-4e3e-8bf5-bc0de16dfe94" alt="Face Recognition Pipeline" /></p>

<h2>üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞</h2>

<p>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ —Å–æ–∑–¥–∞–Ω–∏—é —Å–∏—Å—Ç–µ–º—ã —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –ª–∏—Ü, —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ —Ç—Ä–µ—Ç–∏–π —ç—Ç–∞–ø –ø–∞–π–ø–ª–∞–π–Ω–∞ - <strong>—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ</strong> (recognition/identification).</p>

<p>–ü—Ä–æ–µ–∫—Ç –∏—Å—Å–ª–µ–¥—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ–±—É—á–µ–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö face embeddings –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö loss-—Ñ—É–Ω–∫—Ü–∏–π.</p>

<h2>üö® –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å</h2>

<p>–í —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–∏—Ä–µ —Ä–∞—Å—Ç–µ—Ç –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ –Ω–∞–¥–µ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã (ID-–∫–∞—Ä—Ç—ã, PIN-–∫–æ–¥—ã) –∏–º–µ—é—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:</p>

<ul>
<li>–ú–æ–≥—É—Ç –±—ã—Ç—å –ø–æ—Ç–µ—Ä—è–Ω—ã, —É–∫—Ä–∞–¥–µ–Ω—ã –∏–ª–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã</li>
<li>–¢—Ä–µ–±—É—é—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ –Ω–æ—Å–∏—Ç–µ–ª—è</li>
<li>–ù–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —É–Ω–∏–∫–∞–ª—å–Ω—É—é –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫—É—é –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é</li>
</ul>

<p>–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ª–∏—Ü –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –±–µ—Å–∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ, —É–¥–æ–±–Ω–æ–µ –∏ –Ω–∞–¥–µ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Å–∏—Å—Ç–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.</p>

<h2>üîç –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ</h2>

<h3>–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:</h3>

<ul>
<li>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –ª–∏—Ü (–¥–µ—Ç–µ–∫—Ü–∏—è, –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ, —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ)</li>
<li>–û–±—É—á–µ–Ω–∏–µ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ face embeddings</li>
<li>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö loss-—Ñ—É–Ω–∫—Ü–∏–π</li>
<li>–ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤</li>
<li>Literature review —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤</li>
</ul>

<h2>üß™ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>

<h3>1. ResNet34 —Å Cross Entropy Loss</h3>

<p><a href="https://github.com/me1nna/face-recognition/tree/main/ResNet%20with%20CE">üìÅ –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏</a></p>

<ul>
<li><strong>–ú–æ–¥–µ–ª—å:</strong> ResNet34 (–±–µ–∑ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–∏—è –Ω–∞ –ª–∏—Ü–∞—Ö)</li>
<li><strong>Loss —Ñ—É–Ω–∫—Ü–∏—è:</strong> Cross Entropy</li>
<li><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> Test Accuracy &gt; 0.7</li>
<li><strong>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</strong> –ë–∞–∑–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥, –ø—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è</li>
</ul>

<h3>2. ArcFace Loss Implementation</h3>

<p><a href="https://github.com/me1nna/face-recognition/tree/main/ArcFace">üìÅ –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏</a></p>

<ul>
<li><strong>–ú–æ–¥–µ–ª—å:</strong> ResNet34 –≤ –∫–∞—á–µ—Å—Ç–≤–µ —ç–∫—Å—Ç—Ä–∞–∫—Ç–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</li>
<li><strong>Loss —Ñ—É–Ω–∫—Ü–∏—è:</strong> ArcFace (Additive Angular Margin Loss)</li>
<li><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> Test Accuracy &gt; 0.8 (+14% —É–ª—É—á—à–µ–Ω–∏–µ)</li>
<li><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:</strong> 

<ul>
<li>–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —É–≥–ª–æ–≤–æ–≥–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –∫–ª–∞—Å—Å–∞–º–∏</li>
<li>–£–ª—É—á—à–µ–Ω–Ω–∞—è —Ä–∞–∑–¥–µ–ª–∏–º–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤</li>
<li>–ë–æ–ª–µ–µ –∫–æ–º–ø–∞–∫—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Å–æ–≤</li>
</ul></li>
</ul>

<h2>üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞</h2>

<pre><code>face-recognition/
‚îú‚îÄ‚îÄ ResNet with CE/          # –ë–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å Cross Entropy
‚îÇ   ‚îú‚îÄ‚îÄ model.py            # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ train.py            # –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ evaluate.py         # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
‚îú‚îÄ‚îÄ ArcFace/                # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è ArcFace loss
‚îÇ   ‚îú‚îÄ‚îÄ arcface_loss.py     # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è ArcFace —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å
‚îÇ   ‚îú‚îÄ‚îÄ model.py            # –ú–æ–¥–µ–ª—å —Å ArcFace
‚îÇ   ‚îú‚îÄ‚îÄ train.py            # –û–±—É—á–µ–Ω–∏–µ —Å ArcFace
‚îÇ   ‚îî‚îÄ‚îÄ visualization/      # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
‚îú‚îÄ‚îÄ data/                   # –î–∞–Ω–Ω—ã–µ –∏ preprocessing
‚îú‚îÄ‚îÄ utils/                  # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îî‚îÄ‚îÄ README.md
</code></pre>

<h2>üß† –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è –æ—Å–Ω–æ–≤–∞</h2>

<h3>Cross Entropy Loss</h3>

<p>–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–∞—è loss-—Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–¥–∞—á –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏. –û–¥–Ω–∞–∫–æ –Ω–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –∫–∞—á–µ—Å—Ç–≤–æ embeddings –¥–ª—è –∑–∞–¥–∞—á–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏.</p>

<h3>ArcFace (Additive Angular Margin Loss)</h3>

<p>–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –æ–±—É—á–µ–Ω–∏—é face recognition:</p>

<ul>
<li><strong>–ü—Ä–∏–Ω—Ü–∏–ø:</strong> –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —É–≥–ª–æ–≤–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∫–ª–∞—Å—Å–∞–º–∏</li>
<li><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:</strong> 

<ul>
<li>–õ—É—á—à–∞—è —Ä–∞–∑–¥–µ–ª–∏–º–æ—Å—Ç—å –∫–ª–∞—Å—Å–æ–≤ –≤ embedding space</li>
<li>–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ overfitting</li>
<li>–°–æ—Å—Ç–æ—è–Ω–∏–µ-of-the-art —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</li>
</ul></li>
</ul>

<h2>üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</h2>

<ul>
<li><strong>Python 3.8+</strong></li>
<li><strong>PyTorch 1.10+</strong></li>
<li><strong>OpenCV</strong> - –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–µ –∑—Ä–µ–Ω–∏–µ</li>
<li><strong>NumPy, Pandas</strong> - —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏</li>
<li><strong>Matplotlib, Seaborn</strong> - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</li>
<li><strong>Scikit-learn</strong> - –º–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</li>
</ul>

<h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è</h2>

<table>
<thead>
<tr>
<th>–ú–µ—Ç–æ–¥</th>
<th>Loss Function</th>
<th>Test Accuracy</th>
<th>–£–ª—É—á—à–µ–Ω–∏–µ</th>
</tr>
</thead>
<tbody>
<tr>
<td>–ë–∞–∑–æ–≤—ã–π</td>
<td>Cross Entropy</td>
<td>&gt; 0.70</td>
<td>-</td>
</tr>
<tr>
<td>–£–ª—É—á—à–µ–Ω–Ω—ã–π</td>
<td>ArcFace</td>
<td>&gt; 0.80</td>
<td><strong>+14%</strong></td>
</tr>
</tbody>
</table>

<h2>üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</h2>

<pre><code class="bash"># –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/me1nna/face-recognition.git
cd face-recognition

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫ –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª–∏ (Cross Entropy)
cd "ResNet with CE"
python train.py

# –ó–∞–ø—É—Å–∫ –º–æ–¥–µ–ª–∏ —Å ArcFace
cd ../ArcFace
python train.py
</code></pre>

<h2>üìö –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã</h2>

<h3>–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã Face Recognition:</h3>

<ul>
<li><strong>CosFace</strong> - Large Margin Cosine Loss</li>
<li><strong>SphereFace</strong> - Angular Softmax Loss</li>
<li><strong>ArcFace</strong> - Additive Angular Margin Loss (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)</li>
<li><strong>FaceNet</strong> - Triplet Loss</li>
</ul>

<h2>üìà –ê–Ω–∞–ª–∏–∑ embedding space</h2>

<p>–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:</p>

<ul>
<li>–û—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏</li>
<li>–í—ã—è–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∫–ª–∞—Å—Å—ã</li>
<li>–ü–æ–Ω—è—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å loss-—Ñ—É–Ω–∫—Ü–∏–∏</li>
</ul>

<h2>üìù –õ–∏—Ü–µ–Ω–∑–∏—è</h2>

<p>–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω –ø–æ –ª–∏—Ü–µ–Ω–∑–∏–∏ MIT - —Å–º. —Ñ–∞–π–ª <a href="LICENSE">LICENSE</a> –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.</p>

<h2>üéì –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>

<p>–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –ª–∏—Ü –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö loss-—Ñ—É–Ω–∫—Ü–∏–π (ArcFace) –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–º –ø–æ–¥—Ö–æ–¥–æ–º (Cross Entropy). –≠—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –¥–ª—è –∑–∞–¥–∞—á –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö embeddings.</p>
